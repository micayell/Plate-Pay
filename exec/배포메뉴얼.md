# üìò Plate ÏÑúÎπÑÏä§ Ìè¨ÌåÖ Îß§Îâ¥Ïñº

## 1. GitLab ÏÜåÏä§ ÌÅ¥Î°† Ïù¥ÌõÑ ÎπåÎìú Î∞è Î∞∞Ìè¨Î•º ÏúÑÌïú Î¨∏ÏÑú

## 1-1. ÏÇ¨Ïö© Í∏∞Ïà† Î∞è Î≤ÑÏ†Ñ
- **OS**: Ubuntu 24.04 LTS (AWS EC2)  
- **Java**: 17  
- **Spring Boot**: 3.5.5  
- **Spring Data JPA**: 3.5.5 
- **Spring Security**: 6.3.x 
- **QueryDSL**: 5.0.0  
- **jjwt**: 0.11.5  
- **Database**: PostgreSQL 15
- **Redis**: 7
- **Web/Proxy**: Nginx 1.25 
- **Container**: Docker 28.4.0, Docker Compose 3.8
- **CI/CD**: Jenkins 2.516.2   

---

## 1-2. Ìè¨Ìä∏ ÏÑ§Ï†ï
- **Nginx**: 80, 443 
- **Spring Boot (Backend)**: 8080
- **PostgreSQL**: 5432, Bastion Host Ïó∞Í≤∞Ïãú 15432  
- **Redis**: 6379,Bastion Host Ïó∞Í≤∞Ïãú 16379
- **Jenkins**: 8081
---

### 1-3. ÎπåÎìú Ïãú ÏÇ¨Ïö©ÎêòÎäî ÌôòÍ≤Ω Î≥ÄÏàò (.env.prod)

SPRING_PORT=8080

# RDS (Î∞∞Ìè¨ÌôòÍ≤Ω)
SPRING_DATASOURCE_URL=jdbc:postgresql://rds-postgres-stg.ssafyapp.com:5432/plate123
SPRING_DATASOURCE_USERNAME=plate123
SPRING_DATASOURCE_PASSWORD=pla!Wspa17

# Redis
SPRING_REDIS_HOST=redis-stg.ssafyapp.com
SPRING_REDIS_PORT=6379

# JWT & OAuth
JWT_SECRET=jA+YxXxRUvN+uE0V3zYmWg4kaSFO5XT+ANeOE93Eeb7Inw9BQ4QLQZgqZjC/qEygdz9WejAjNs80zyPvjh+7tA==
KAKAO_CLIENT_ID=c7b03e069625574a3cde960ec972f4d5
KAKAO_CLIENT_SECRET=DJRAJ3PLmrehXsotKuvIfqZJUs8Ue2mJ
SSAFY_CLIENT_ID=1de0a8d6-f500-4643-b6ce-dff65087e7e1
SSAFY_CLIENT_SECRET=3ab34ccd-4caf-41bc-895c-109d8edc5225
SSAFY_FINANCIAL_KEY=bab1335d4ac04c019f84397600ff1198

# Elasticsearch
ELASTIC_PORT=9200
ELASTIC_URI=http://plate-elasticsearch:9200

# Mail
MAIL_USERNAME=yolo.bringit.207
MAIL_PASSWORD=lhufhwoaqgwdjlpj

# AWS S3 (Î∞∞Ìè¨ÌôòÍ≤Ω)
AWS_BUCKET=ssafyapp-stg-project-prv-data
AWS_REGION=ap-northeast-2
AWS_ACCESS_KEY=AKIAW7FB3555AGY6D7KL
AWS_SECRET_KEY=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

# Ï∂îÍ∞Ä
AWS_PUBLIC_URL=s3://ssafyapp-stg-project-prv-data/f3qzjb/
AWS_ENDPOINT_URL=https://s3.ap-northeast-2.amazonaws.com

KAKAO_API_KEY=84d7c3edbf73551e3fcaf201f56d4ed3

SWAGGER_SERVER_URL=https://j13c108.p.ssafy.io:8080

OAUTH_REDIRECT_HOST=https://j13c108.p.ssafy.io

---

### 1-4. Spring Boot ÏÑ§Ï†ï (application.yml)
```
spring:
  profiles:
    default: dev

  jackson:
    time-zone: Asia/Seoul

  #THYMELEAF
  thymeleaf:
    cache: false
    check-template: true
    check-template-location: true
    enabled: true
    encoding: UTF-8
    mode: HTML
    prefix: classpath:templates/
    suffix: .html
    template-resolver-order: 1

  # Database
  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
  # JPA
  jpa:
    hibernate:
      ddl-auto: update
      use_sql_comments: true
      jdbc:
        time_zone: Asia/Seoul
    show-sql: true

  # email
  mail:
    host: smtp.gmail.com
    port: 587
    username: yolo.bringit.207
    password: lhuf hwoa qgwd jlpj
    properties:
      mail:
        smtp:
          auth: true
          timeout: 5000
          starttls:
            enable: true

  # oauth
  security:
    oauth2:
      client:
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          ssafy:
            authorization-uri: https://project.ssafy.com/oauth/sso-check
            token-uri: https://project.ssafy.com/ssafy/oauth2/token
            user-info-uri: https://project.ssafy.com/ssafy/resources/userInfo
            user-name-attribute: userId
        registration:
          kakao:
            client-id: ${KAKAO_CLIENT_ID}
            client-secret: ${KAKAO_CLIENT_SECRET}
            client-authentication-method: client_secret_post
            redirect-uri: ${OAUTH_REDIRECT_HOST}:8080/login/oauth2/code/kakao
            authorization-grant-type: authorization_code
            client-name: kakao
            scope:
              - profile_nickname
              - profile_image
              - account_email
          ssafy:
            provider: ssafy
            client-id: ${SSAFY_CLIENT_ID}
            client-secret: ${SSAFY_CLIENT_SECRET}
            authorization-grant-type: authorization_code
            client-authentication-method: client_secret_post
            redirect-uri: ${OAUTH_REDIRECT_HOST}:8080/login/oauth2/code/ssafy
            scope: [ ]

  # cache
  cache:
    type: caffeine

  # redis
  data:
    redis:
      port: ${SPRING_REDIS_PORT}
      host: ${SPRING_REDIS_HOST}

# SSAFY
ssafy:
  api:
    key: ${SSAFY_FINANCIAL_KEY}
    url: https://finopenapi.ssafy.io

# OCR
ocr:
  api:
    url: http://j13c108.p.ssafy.io:8000

# FACE
face:
  api:
    url: http://j13c108.p.ssafy.io:8100

# CODEF
codef:
  api:
    client-id: 01a1a57b-9ec1-4fd0-b88b-2b373b33a00a
    client-secret: efcd123d-ebe5-4f7e-94bf-1ad03ced21a6
    url: https://development.codef.io

# JWT
jwt:
  secret: ${JWT_SECRET}
  expiration: 1296000000

# S3/R2
aws:
  s3:
    publicUrl: https://pub-1b87520b13004863b6faad8458f37850.r2.dev
    endpointUrl: https://893ddb890911cb604dfcb67dbb99057c.r2.cloudflarestorage.com
    bucket: yolo-bringit
    region: APAC
  accessKey: 41fa6efee1a1029b21a8086312e801c1
  secretKey: 55115f9f5018f9c0d3400c9bee21481d2d12a19e8aaa928f2f9e941372d77f80

# swagger
springdoc:
  swagger-ui:
    enabled: true
    display-request-duration: true

swagger:
  server-url: http://localhost:8080

server.port: 8080

app:
  front.url: http://localhost:8081

---

spring:
  config:
    activate:
      on-profile: local

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true
        jdbc.lob.non_contextual_creation: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
    database: postgresql

app:
  front.url: http://localhost:8081,http://localhost:5173

---
spring:
  config:
    activate:
      on-profile: prod

  datasource:
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 30000
      max-lifetime: 1800000
      connection-timeout: 30000

    driver-class-name: org.postgresql.Driver
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: false
        jdbc.lob.non_contextual_creation: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        default_schema: plate
    show-sql: false
    database: postgresql
    open-in-view: false

  data:
    redis:
      host: ${SPRING_REDIS_HOST}
      port: ${SPRING_REDIS_PORT}
      repositories:
        enabled: false


  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        smtp:
          auth: true
          timeout: 5000
          starttls:
            enable: true

  elasticsearch:
    uris: ${ELASTIC_URI}
    connection-timeout: 5s
    socket-timeout: 30s


server:
  port: ${SPRING_PORT}

# JWT
jwt:
  secret: ${JWT_SECRET}
  expiration: 1296000000

# S3/R2
aws:
  s3:
    publicUrl: ${AWS_PUBLIC_URL}
    endpointUrl: ${AWS_ENDPOINT_URL}
    bucket: ${AWS_BUCKET}
    region: ${AWS_REGION}
  accessKey: ${AWS_ACCESS_KEY}
  secretKey: ${AWS_SECRET_KEY}

springdoc:
  swagger-ui:
    enabled: true
    display-request-duration: true

logging:
  level:
    root: INFO
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql: WARN
    org.elasticsearch.client: DEBUG
    org.springframework.data.elasticsearch.client.WIRE: TRACE

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: never

app:
  front.url: http://13.125.255.131:80,http://localhost:5173

swagger:
  server-url: https://j13c108.p.ssafy.io

---

spring:
  sql:
    init:
      mode: always
      encoding: UTF-8
  config:
    activate:
      on-profile: jinnodev

  datasource:
    url: jdbc:postgresql://localhost:5432/platepay
    driver-class-name: org.postgresql.Driver
    username: postgres
    password: love140515

    # JPA
  jpa:
    hibernate:
      ddl-auto: update
      use_sql_comments: true
    show-sql: true
    defer-datasource-initialization: true

    # email
  mail:
    host: smtp.gmail.com
    port: 587
    username: yolo.bringit.207
    password: lhuf hwoa qgwd jlpj
    properties:
      mail:
        smtp:
          auth: true
          timeout: 5000
          starttls:
            enable: true

  # redis
  data:
    redis:
      host: ${SPRING_REDIS_HOST}
      port: ${SPRING_REDIS_PORT}

  # JWT
jwt:
  secret: ${JWT_SECRET}
  expiration: 1296000000

# S3/R2
aws:
  s3:
    publicUrl: https://pub-1b87520b13004863b6faad8458f37850.r2.dev
    endpointUrl: https://893ddb890911cb604dfcb67dbb99057c.r2.cloudflarestorage.com
    bucket: yolo-bringit
    region: APAC
  accessKey: 41fa6efee1a1029b21a8086312e801c1
  secretKey: 55115f9f5018f9c0d3400c9bee21481d2d12a19e8aaa928f2f9e941372d77f80

# swagger
springdoc:
  swagger-ui:
    enabled: true
    display-request-duration: true

swagger:
  server-url: http://localhost:8080/api/v1/users

server.port: 8080

app:
  front.url: http://localhost:8081,http://localhost:5173

---
  
### 1-5. Î∞∞Ìè¨ Ïãú ÌäπÏù¥ÏÇ¨Ìï≠
- Î∞îÏä§Ìã∞Ïò® Ìò∏Ïä§Ìä∏Î•º Ïù¥Ïö©ÌïòÏó¨ Ï†ëÍ∑º Ï†úÌïúÏùÑ Í±∏Ïñ¥ÎíÄÏúºÎØÄÎ°ú, Ïó∞Í≤∞ Ïãú Í∏∞Ï°¥ Ìè¨Ìä∏Ïóê ÏïûÏóê 1ÏùÑ Î∂ôÏù∏ Ìè¨Ìä∏Î≤àÌò∏Î•º Ïó∞Í≤∞Ìï¥ÏïºÎê®.
- ÌòÑÏû¨ CI/CD Ïãú ÏûêÎèôÏúºÎ°ú credentialÎ°ú .env ÌååÏùºÏùÑ Ï£ºÏûÖÌï¥Ï£ºÍ≥† ÏûàÏùå.
---

### 1-6. DB Ï†ëÏÜç Ï†ïÎ≥¥Í∞Ä Ï†ïÏùòÎêú ÌååÏùº Î™©Î°ù
- .env.prod
